# ü§ñ Telegram Bot - –ó–∞–∫–∞–∑—ã —á–µ—Ä–µ–∑ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä

Telegram –±–æ—Ç –¥–ª—è –ø—Ä–∏–µ–º–∞ –∑–∞–∫–∞–∑–æ–≤ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- –ó–∞–∫–∞–∑ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å –≤—ã–±–æ—Ä–æ–º —Ä–∞–∑–º–µ—Ä–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–∫—Ä–æ–ø, –≤–ø–∏—Å–∞—Ç—å —Å –ø–æ–ª—è–º–∏)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF –æ—Ç—á–µ—Ç–æ–≤

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Backend
- **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä:** `backend/src/controllers/telegramWebhookController.ts`
- **–°–µ—Ä–≤–∏—Å—ã:**
  - `backend/src/services/telegramService.ts` - –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
  - `backend/src/services/telegramBotCommands.ts` - –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
  - `backend/src/services/photoOrderService.ts` - –ó–∞–∫–∞–∑—ã —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
  - `backend/src/services/imageProcessingService.ts` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–†–æ—É—Ç—ã:** `backend/src/routes/webhooks.ts`

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **–¢–∞–±–ª–∏—Ü–∞:** `photo_orders` - –ó–∞–∫–∞–∑—ã —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- **–°—Ö–µ–º–∞:**
```sql
CREATE TABLE photo_orders (
  id INTEGER PRIMARY KEY,
  chat_id TEXT NOT NULL,
  username TEXT,
  first_name TEXT,
  original_photos TEXT[], -- JSON –º–∞—Å—Å–∏–≤
  selected_size JSON,     -- JSON –æ–±—ä–µ–∫—Ç
  processing_options JSON,
  quantity INTEGER DEFAULT 1,
  total_price INTEGER DEFAULT 0,
  status TEXT DEFAULT 'pending',
  notes TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

## üì± –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- `/order_photo` - –ó–∞–∫–∞–∑ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- `/my_orders` - –ú–æ–∏ –∑–∞–∫–∞–∑—ã
- `/stock` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤
- `/stock_pdf` - PDF –æ—Ç—á–µ—Ç –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º

### –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–∫–∞–∑–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
1. **–í—ã–±–æ—Ä —Ä–∞–∑–º–µ—Ä–∞** - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
2. **–í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏** - –ö—Ä–æ–ø, –≤–ø–∏—Å–∞—Ç—å —Å –ø–æ–ª—è–º–∏, —É–º–Ω—ã–π –∫—Ä–æ–ø
3. **–í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞** - –ö–Ω–æ–ø–∫–∏ 1-10 –∫–æ–ø–∏–π
4. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞** - –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

## üñºÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –†–∞–∑–º–µ—Ä—ã —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- 9x13 —Å–º
- 10x15 —Å–º
- 13x18 —Å–º
- 15x21 —Å–º
- 21x29.7 —Å–º (A4)

### –†–µ–∂–∏–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–ö—Ä–æ–ø** - –û–±—Ä–µ–∑–∫–∞ –ø–æ–¥ —Ä–∞–∑–º–µ—Ä –±–µ–∑ –ø–æ–ª–µ–π
- **–í–ø–∏—Å–∞—Ç—å —Å –ø–æ–ª—è–º–∏** - –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –±–µ–ª—ã–º–∏ –ø–æ–ª—è–º–∏
- **–£–º–Ω—ã–π –∫—Ä–æ–ø** - –ò–ò –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∞–∂–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **Sharp** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **Multer** - –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- **Telegram Bot API** - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_WEBHOOK_URL=https://your-domain.com/api/webhooks/telegram
```

### Webhook
- URL: `/api/webhooks/telegram`
- –ú–µ—Ç–æ–¥: POST
- –û–±—Ä–∞–±–æ—Ç–∫–∞: `telegramWebhookController.handleWebhook`

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤

- `pending` - –û–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `processing` - –í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `completed` - –ó–∞–≤–µ—Ä—à–µ–Ω
- `cancelled` - –û—Ç–º–µ–Ω–µ–Ω

## üöß –°—Ç–∞—Ç—É—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–æ—Ç–∞
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
- üîÑ –ò–ò –¥–ª—è —É–º–Ω–æ–≥–æ –∫—Ä–æ–ø–∞ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

## üìù TODO

1. –ó–∞–≤–µ—Ä—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ò–ò –¥–ª—è —É–º–Ω–æ–≥–æ –∫—Ä–æ–ø–∞
3. –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ
4. –£–ª—É—á—à–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥
5. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

